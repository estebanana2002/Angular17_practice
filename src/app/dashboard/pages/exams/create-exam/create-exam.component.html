<div
  class="shadow-lg px-0 sticky z-10 top-0 h-16 lg:py-2.5 lg:w-[100%] xl:w-[100%] 2xl:w-[100%] mb-4 bg-opacity-90 bg-blur bg-blend-luminosity backdrop-filter backdrop-blur-lg">
  <div class="px-6 pt-2 flex items-start space-x-4 2xl:container">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
      <path stroke-linecap="round" stroke-linejoin="round" d="M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25m18 0A2.25 2.25 0 0 0 18.75 3H5.25A2.25 2.25 0 0 0 3 5.25m18 0V12a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 12V5.25" />
    </svg>

    <h5 hidden class="text-xl ms-4 font-medium lg:block">Generar examen</h5>
    <button class="w-12 h-16 -mr-2 border-r lg:hidden">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 my-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
    </button>
  </div>
</div>


  <form class="mx-4 lg:mx-5 sm:mt-5" [formGroup]="examForm">
    <section class="grid gap-2 my-4 grid-cols-12">
      <div class="col-span-12 lg:col-span-7 shadow-xl rounded-2xl mt-10">
        <!-- component -->
        <div class="isolate bg-white px-6 lg:px-8">
          <div class="absolute inset-x-0 top-[-10rem] -z-10 transform-gpu overflow-hidden blur-3xl sm:top-[-20rem]" aria-hidden="true">
            <div
              class="relative left-1/2 -z-10 aspect-[1155/678]
              w-[36.125rem] max-w-none -translate-x-1/2 rotate-[30deg] bg-gradient-to-tr
              from-[#ff80b5] to-[#9089fc] opacity-30 sm:left-[calc(50%-40rem)] sm:w-[72.1875rem]"
              style="clip-path: polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)">
            </div>
          </div>
          <div class="mx-auto max-w-2xl text-center h-32">
            <h2 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">
              Nuevo examen
            </h2>
            <p class="mt-2 text-lg leading-7 text-gray-600">
              Móntate en el carro, ponte la chaqueta, shorty
              Ellos hablan tanto que me da jaqueca, yo ni
              Hacer mil, arde mi cara 'e ganador
              Un rubí, oro si pagan mi sazón
            </p>
          </div>

          <div class="grid grid-cols-1 gap-x-8 gap-y-6 sm:grid-cols-2 mt-5">

            <div class="">
              <label for="phone-number" class="block text-sm font-semibold leading-6 text-dark">Grupo</label>
              <div class="relative mt-2.5">
                <div class="absolute inset-y-0 left-0 flex items-center">
                  <select id="group" name="group"
                  class="h-full rounded-md border-0 bg-transparent bg-none py-0 pl-2 pr-3 text-dark shadow-blue-500 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm">
                    <option [value]="group" *ngFor="let group of Groups">{{group}}</option>
                  </select>
                </div>
                <input type="text" name="phone-number" formControlName="group"
                id="phone-number" autocomplete="tel" placeholder="Ej. 701"
                class="shadow-blue-500 block w-full rounded-md border-0 px-3.5 py-2 pl-20 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
              </div>
            </div>

            <div class="">
              <label for="materia" class="block text-sm font-semibold leading-6 text-dark mb-2.5">Materia</label>
              <select id="materia" name="materia" formControlName="subject"
              class="shadow-blue-500 block w-full p-2 border border-gray-300 ring-gray-300 text-dark rounded-md focus:outline-none focus:ring focus:border-indigo-500 sm:text-sm">
                <option selected disabled>Seleccione la materia</option>
                <option [value]="sub" *ngFor="let sub of Subjects">{{sub}}</option>
              </select>
            </div>


            <div class="sm:col-span-2">
              <label for="teacher" class="block text-sm font-semibold leading-6 text-dark mb-2.5">Nombre del instructor || Profesor</label>
              <div class="relative mt-2.5">
                <div class="absolute inset-y-0 left-0 flex items-center">
                  <select id="teacher" name="teacher"
                  class="h-full rounded-md border-0 bg-transparent bg-none py-0 pl-2 pr-2  text-gray-400 shadow-blue-500 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm">
                    <option selected disabled>Titulo</option>
                    <option value="Ing.">Ingeniero</option>
                    <option value="Lic.">Licenciado</option>
                    <option value="MDG.">Maestro de diseño</option>
                  </select>
                </div>
                <input type="text" name="teacher" id="teacher" formControlName="teacher"
                class="shadow-blue-500 block w-full rounded-md border-0 px-3.5 py-2 pl-40 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
              </div>
            </div>

            <div class="">
              <label for="title" class="block text-sm font-semibold leading-6 text-black">Fecha de inicio</label>
              <div class="mt-2.5">
                <input type="date" name="title" id="title" formControlName="date"
                placeholder="Ej. Examen 5° cuatrimestre Literatura"
                class="block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset shadow-blue-500 ring-blue-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-blue-400 sm:text-sm sm:leading-6">
              </div>
            </div>

            <div class="">
              <label for="duration" class="block text-sm font-semibold leading-6 text-dark mb-2.5">Duracion del examen</label>
              <select id="duration" name="duration" formControlName="duration"
              class="shadow-blue-500 block w-full p-2 border border-gray-300 ring-gray-300 text-dark rounded-md focus:outline-none focus:ring focus:border-indigo-500 sm:text-sm">
                <option selected disabled>Seleccione la duracion del examen</option>
                <option value="30">30 min.</option>
                <option value="60">1 hr.</option>
                <option value="90">1 hr 30 min.</option>
                <option value="120">2 hrs.</option>
              </select>
            </div>

            <div class="sm:col-span-2">
              <label for="title" class="block text-sm font-semibold leading-6 text-black">Titulo del examen</label>
              <div class="mt-2.5">
                <input type="text" name="title" id="title" formControlName="title"
                placeholder="Ej. Examen 5° cuatrimestre Literatura"
                class="block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset shadow-blue-500 ring-blue-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-blue-400 sm:text-sm sm:leading-6">
              </div>
            </div>

            <div class="sm:col-span-2">
              <label for="description" class="block text-sm font-semibold leading-6 text-red-600">Descripción o indicaciones</label>
              <div class="mt-2.5">
                <textarea #des name="description" id="description" rows="4" formControlName="description"
                placeholder="Ej. Seleccione las respuestas correctas" maxlength="150"
                class="block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset shadow-blue-500 ring-blue-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-blue-400 sm:text-sm sm:leading-6"></textarea>
                <div class="flex items-end justify-end">
                  <small class="text-xs text-gray-500">Caracteres {{des.value.length}} / 150</small>
                </div>
              </div>
            </div>

            <div class="sm:col-span-2">
              @for ( question of getQuestions.controls; track question.value; let i = $index; ) {

                <div class="mb-5 space-y-2">
                  <div
                    class="group flex flex-col gap-2 rounded-lg bg-slate-100 p-3 shadow-lg cursor-pointer hover:border-zinc-200 hover:shadow-lg transform hover:scale-105 transition-transform"
                    tabindex="1">
                    <div class="flex items-center justify-between mt-3">
                      <span>{{i + 1}}° {{question.value?.question}} </span>
                      <button type="button" appTooltip="Eliminar pregunta" (click)="deleteQuestion(i)"
                      class="px-4 py-1 me-2 text-sm text-red-500 bg-transparent rounded-full hover:bg-red-500 hover:text-white">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                          <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
                        </svg>
                      </button>
                    </div>
                    <div
                      class="invisible h-auto max-h-0 items-center opacity-0 transition-all group-focus:visible group-focus:max-h-screen group-focus:opacity-100 group-focus:duration-700">
                      @for (answer of question.value?.answer.value; track answer) {
                        <div class="col-span-5 my-3">
                          <label>
                            <input type="radio" value="1" class="peer hidden" name="answer">
                            <div (click)="selectCorrect(answer)"
                            class="hover:bg-gray-50 bg-white flex items-center justify-between px-4 py-2 border-2 rounded-lg cursor-pointer text-sm border-gray-200 group shadow-lg">
                                <h2 class="font-medium text-gray-700">{{answer.answer}}</h2>
                                <svg xmlns="http://www.w3.org/2000/svg" appTooltip="Respuesta correcta" *ngIf="answer.correct"
                                fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-9 h-9 text-green-600">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>

                                <svg xmlns="http://www.w3.org/2000/svg" appTooltip="Respuesta incorrecta" *ngIf="!answer.correct"
                                fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-9 h-9 text-red-600">
                                  <path stroke-linecap="round" stroke-linejoin="round" d="m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                                </svg>
                            </div>
                          </label>
                        </div>
                      }
                    </div>
                  </div>
                </div>
              }
            </div>

            <div class="flex gap-x-4 sm:col-span-2">
              <div class="flex h-6 items-center">
                <button type="button" class="bg-gray-200 flex w-8 flex-none cursor-pointer rounded-full p-px ring-1 ring-inset ring-gray-900/5 transition-colors duration-200 ease-in-out focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600" role="switch" aria-checked="false" aria-labelledby="switch-1-label">
                  <span class="sr-only">Agree to policies</span>
                  <span aria-hidden="true" class="translate-x-0 h-4 w-4 transform rounded-full bg-white shadow-sm ring-1 ring-gray-900/5 transition duration-200 ease-in-out"></span>
                </button>
              </div>
              <label class="text-sm leading-6 text-gray-600" id="switch-1-label">
                By selecting this free palestine
                <a href="#" class="font-semibold text-red-600">privacy&nbsp;policy</a>.
              </label>
            </div>
          </div>

          <div class="my-10">
            <button type="submit" (click)="saveExam()"
            [disabled]="examForm.invalid || getQuestions.controls.length < 4"
              class="block w-full rounded-md bg-green-500 px-3.5 py-2.5 text-center disabled:bg-green-200
              text-sm font-semibold text-white shadow-sm hover:bg-green-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">
              Registrar examen
            </button>
          </div>
        </div>
      </div>

      <div class="col-span-12 lg:col-span-5 shadow-xl rounded-2xl mt-10">
        <div class="isolate bg-white px-6 lg:px-8">
          <div class="mx-auto max-w-2xl text-center h-32">
            <h2 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">
              Reactivos
            </h2>
            <p class="mt-2 text-lg leading-7 text-gray-600">
              En esta sección ingrese cada uno de los reactivos del examen, agregando las posibles respuestas
              y el inciso correcto.
            </p>
          </div>

          <div class="grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-6 mt-5">
            <div class="sm:col-span-4 col-span-6">
              <label for="question" class="block text-sm font-semibold leading-6">
                Ingrese la pregunta
              </label>
              <div class="mt-2.5">
                <textarea name="question" id="question" rows="2" [formControl]="question"
                placeholder="Ej. ¿Cuantos dedos tiene la pata trasera de un cuyo?"
                class="block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"></textarea>
              </div>
            </div>

            <div class="sm:col-span-2 col-span-6">
              <label for="rate"
              class="block text-sm font-semibold leading-6 text-black">Valor de la pregunta</label>
              <div class="mt-2.5">
                <input type="number" name="rate" id="rate" [formControl]="points"
                placeholder="Ej. 5 pt." max="10" min="0"
                class="block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset shadow-blue-500 ring-blue-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-blue-400 sm:text-sm sm:leading-6">
              </div>
            </div>

            <div class="col-span-6 mx-auto max-w-2xl text-center h-24 mt-5">
              <h2 class="text-2xl font-bold tracking-tight text-gray-900 sm:text-3xl">
                Respuestas
              </h2>
              <p class="mt-2 text-lg leading-6 text-gray-600">
                Ingrese las respuestas de la pregunta a agregar.
              </p>
            </div>

            <div class="col-span-5">
              <label for="answer"
              class="block text-sm font-semibold leading-6 text-black">Respuesta</label>
              <div class="mt-2.5">
                <input type="text" name="answer" id="answer" [formControl]="answer"
                placeholder="Ej. 5 pt." max="10" min="0"
                class="block w-full rounded-md border-0 px-3.5 py-2 text-gray-900 shadow-sm ring-1 ring-inset shadow-blue-500 ring-blue-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-blue-400 sm:text-sm sm:leading-6">
              </div>
            </div>

            <div class="col-span-1 flex items-center justify-center">
              <button type="button" appTooltip="Agregar respuesta" (click)="addAnswer()"
              [disabled]="answer.invalid"
              class="px-4 py-1 text-sm mt-8 ms-4 text-slate-100 bg-green-400 hover:bg-green-600 rounded-lg">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                </svg>
              </button>
            </div>

            @for (answer of getAnswers.controls; track answer; let i = $index;) {
              <div class="col-span-6">
                <label>
                  <input type="radio" value="1" class="peer hidden" name="answer">
                  <div (click)="selectCorrect(answer?.value)"
                  class="hover:bg-gray-50 flex items-center justify-between px-4 py-2 border-2 rounded-lg cursor-pointer text-sm border-gray-200 group peer-checked:border-blue-500">
                      <h2 class="font-medium text-gray-700">{{answer.value?.answer}}</h2>
                      <svg xmlns="http://www.w3.org/2000/svg" appTooltip="Respuesta correcta" *ngIf="answer.value?.correct"
                      fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-9 h-9 text-green-600">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                      </svg>

                      <svg xmlns="http://www.w3.org/2000/svg" appTooltip="Respuesta incorrecta" *ngIf="!answer.value?.correct"
                      fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-9 h-9 text-red-600">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                      </svg>
                  </div>
                </label>
              </div>
            }

            <div class="col-span-6">
              <button type="button" (click)="addQuestion()"
              [disabled]="question.invalid || points.invalid || answers.length < 2"
                class="block w-full rounded-md bg-cyan-500 px-3.5 py-2.5 disabled:bg-cyan-200
                text-center text-sm font-semibold text-white shadow-sm hover:bg-cyan-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">
                Agregar pregunta
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>
  </form>


